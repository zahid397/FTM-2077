<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FTM-2077 Mission Control</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #1a1a1a; color: white; }
        input { padding: 10px; width: 300px; border-radius: 5px; border: none; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; border-radius: 5px; }
        button:hover { background: #0056b3; }
        #output { background: #333; padding: 15px; margin-top: 10px; white-space: pre-wrap; border-radius: 5px; }
        audio { margin-top: 15px; width: 100%; display: none; }
    </style>
</head>
<body>

    <h1>üöÄ FTM-2077 Control</h1>
    
    <input type="text" id="cmd" placeholder="Type your command (e.g., Hello Jarvis)...">
    <button onclick="sendMission()">Send Mission</button>

    <audio id="voicePlayer" controls></audio>

    <div id="output">Waiting for command...</div>

    <script>
        const BASE_URL = "https://ftm-2077.onrender.com"; 
        const API_URL = `${BASE_URL}/api`;

        async function sendMission() {
            const cmdInput = document.getElementById("cmd");
            const output = document.getElementById("output");
            const player = document.getElementById("voicePlayer");
            const cmd = cmdInput.value.trim();

            if (!cmd) { alert("Please enter a command!"); return; }

            output.textContent = "Processing... ‚è≥";
            
            try {
                const res = await fetch(`${API_URL}/execute`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ command: cmd, persona: "JARVIS" })
                });

                if (!res.ok) throw new Error("Network response was not ok");

                const data = await res.json();
                output.textContent = JSON.stringify(data, null, 2);

                if (data.audio) {
                    // ‡¶Ö‡¶°‡¶ø‡¶ì ‡¶™‡¶æ‡¶• ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ
                    const audioSrc = data.audio.startsWith("http") ? data.audio : `${BASE_URL}${data.audio}`;
                    player.src = audioSrc;
                    player.style.display = "block";
                    player.play().catch(e => console.log("Click play to hear audio"));
                }

            } catch (err) {
                output.textContent = "Error: Backend unreachable ‚ùå";
                console.error(err);
            }
        }
    </script>
</body>
</html>
